graph TD
    %% Input Sources
    Market[ðŸ“¡ Market Data] -->|Price S| Bot
    Utils[ðŸ§  Analysis Engine] -->|Volatility Ïƒ / RSI| Bot
    FR[ðŸ’¸ Funding Rate] -->|Bias Signal| Bot
    UCB[ðŸ¤– UCB Manager] -->|Gamma Î³| Bot

    %% Core Logic
    subgraph "Dual Mindset Engine (Avellaneda Strategy)"
        Bot -->|Params| Logic{Pricing Logic}
        
        Logic -->|Input| P1["Inventory (q)"]
        Logic -->|Input| P2["Risk Aversion (Î³)"]
        Logic -->|Input| P3["Volatility (Ïƒ)"]
        
        subgraph "Avellaneda Formula"
            P1 & P2 & P3 --> Calc1["Reserve Price (r) = S - qÎ³ÏƒÂ²(T-t)"]
            P2 & P3 --> Calc2["Spread (Î´) = Â½Î³ÏƒÂ²T + (1/Î³)ln(...)"]
        end

        Calc1 & Calc2 --> Bid["Bid = r - Î´"]
        Calc1 & Calc2 --> Ask["Ask = r + Î´"]

        Bid -->|Tunnel Clamp 0.02%| SafeBid[Final Bid]
        Ask -->|Tunnel Clamp 0.02%| SafeAsk[Final Ask]
    end

    %% Execution
    SafeBid -->|Limit Order| Exchange[ðŸ›ï¸ Gate.io]
    SafeAsk -->|Limit Order| Exchange
